<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Customer Build Sheet</title>
  <style>
    :root {
      --bg: #0b0f1a; --panel: rgba(255,255,255,0.06); --text: #e6e9ef; --muted: #aab2c0; --accent: #7c5cff; --accent-2: #00d1ff;
      --radius: 16px; --shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; color: var(--text); font-family: var(--sans);
      background: radial-gradient(1000px 600px at 20% -10%, rgba(124,92,255,0.25), transparent 60%),
                  radial-gradient(700px 500px at 100% 0%, rgba(0,209,255,0.18), transparent 50%),
                  linear-gradient(180deg, #05070d, var(--bg));
    }
    a { color: var(--accent-2); text-decoration: none; }
    .wrap { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
    header { display:flex; align-items:center; justify-content:space-between; gap: 16px; margin-bottom: 14px; }
    .brand { display:flex; align-items:center; gap:12px; }
    .logo { width: 40px; height: 40px; border-radius: 12px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04); }
    h1 { margin:0; font-size: 22px; color: var(--text); }

    .nav { display:flex; gap:10px; flex-wrap:wrap; margin-bottom: 22px; }
    .nav a { padding: 8px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,0.14); background: rgba(255,255,255,0.06); color: #fff; text-decoration:none; }
    .nav a.active { background: linear-gradient(135deg, var(--accent), var(--accent-2)); border-color: transparent; }

    .grid { display:grid; grid-template-columns: 1.05fr 0.95fr; gap: 20px; }
    @media (max-width: 980px) { .grid { grid-template-columns: 1fr; } }
    .card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.04); backdrop-filter: saturate(120%) blur(8px); }
    .card h2 { margin:0; padding: 14px 16px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .card .content { padding: 16px; }

    .field { display:grid; grid-template-columns: 180px 1fr; gap: 12px; align-items:center; margin: 10px 0; }
    .field label { color:#aab2c0; font-size: 13px; }
    .field input, .field select {
      width: 100%; padding: 10px 12px; color: #e6e9ef;
      background: #141a26; border: 1px solid rgba(255,255,255,0.12); border-radius: 12px; outline: none;
    }
    .field input:focus, .field select:focus { border-color: #00d1ff; }
    select#dc { background-color: #111522; color: #ffffff; }
    option { background-color: #0d1018; color: #ffffff; }

    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .btn { border: 1px solid rgba(255,255,255,0.18); background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); padding: 10px 14px; border-radius: 12px; color: #e6e9ef; cursor:pointer; }
    .btn.primary { border-color: transparent; background: linear-gradient(135deg, #7c5cff, #00d1ff); color:#fff; }
    .btn:hover { transform: translateY(-1px); }

    .tabs { display:flex; gap: 8px; padding: 12px 12px 0; border-bottom: 1px solid rgba(255,255,255,0.08); flex-wrap: wrap; }
    .tab { padding: 8px 12px; border-radius: 10px; cursor: pointer; font-size: 13px; color: #aab2c0; border: 1px solid transparent; }
    .tab.active { color: white; border-color: rgba(255,255,255,0.14); background: rgba(255,255,255,0.06); }

    .code { background:#0a0e18; color:#dbe2f1; border:1px solid rgba(255,255,255,0.1); border-radius:12px; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; padding:14px; white-space:pre; overflow:auto; font-size:13px; }
    .copyRow { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }
    .badges { display:flex; gap:6px; flex-wrap:wrap; margin-top:8px; }
    .badge { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px; color:#fff; padding:6px 8px; border-radius:999px; border:1px solid rgba(255,255,255,0.14); background:rgba(255,255,255,0.06); }

    .page { display:none; } .page.active { display:block; }
    .two-col { display:grid; grid-template-columns: 1.05fr 0.95fr; gap: 20px; }
    @media (max-width: 980px) { .two-col { grid-template-columns: 1fr; } }

    .test { margin-top: 18px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; color: #bfe0ff; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Customer Build Sheet</h1></div>
      <div class="row">
        <button class="btn" id="btnReset">Reset</button>
        <button class="btn primary" id="btnSample">Load Sample</button>
      </div>
    </header>

    <nav class="nav">
      <a href="#home" data-route>Home</a>
      <a href="#arista" data-route>Page 1: Arista's</a>
      <a href="#dcnm" data-route>Page 2: DCNM</a>
      <a href="#localin" data-route>Page 3: Local-In Policy Golden Config</a>
      <a href="#future" data-route>Page 4: Placeholder</a>
    </nav>

    <section id="page-home" class="page active">
      <div class="card">
        <h2>Inputs</h2>
        <div class="content" id="formArea">
          <div class="field"><label for="custName">Customer Name</label><input id="custName" placeholder="Acme Corp" /></div>
          <div class="field"><label for="sfid">Salesforce ID</label><input id="sfid" placeholder="006XXXXXXXXXXXX" /></div>
          <div class="field"><label for="dc">Datacenter</label>
            <select id="dc">
              <option value="">Select…</option>
              <option>LAX</option><option>IAD</option><option>ORD</option><option>DAL</option><option>HNK</option><option>LND</option><option>SIN</option>
            </select>
          </div>
          <div class="field"><label for="wanVlan">WAN VLAN</label><input id="wanVlan" inputmode="numeric" placeholder="200" /></div>
          <div class="field"><label></label><div class="muted">WAN Name → <span id="wanNamePreview">(auto)</span></div></div>
          <div class="field"><label for="vcgVlan">VCG VLAN</label><input id="vcgVlan" inputmode="numeric" placeholder="210" /></div>
          <div class="field"><label></label><div class="muted">VCG Name → <span id="vcgNamePreview">(auto)</span></div></div>
          <div class="field"><label for="cidr">IPAM Public IP (CIDR)</label><input id="cidr" placeholder="198.51.100.32/28" /></div>
          <div class="badges">
            <div class="badge">Gateway: <span id="gw">—</span></div>
            <div class="badge">Firewall: <span id="fw">—</span></div>
            <div class="badge">Mask: <span id="mask">—</span></div>
            <div class="badge">Desc: <span id="desc">—</span></div>
          </div>
        </div>
      </div>
    </section>

    <section id="page-arista" class="page">
      <div class="two-col">
        <section class="card">
          <h2>Outputs (Arista)</h2>
          <div class="tabs" role="tablist">
            <div class="tab active" data-tab="wanvlan">WAN VLAN</div>
            <div class="tab" data-tab="vcgvlan">VCG VLAN</div>
            <div class="tab" data-tab="route">Route</div>
            <div class="tab" data-tab="bgp">BGP SVC Leaves 01–04</div>
            <div class="tab" data-tab="all">All</div>
          </div>
          <div class="content">
            <div id="sec-wanvlan"><div class="sectionTitle">Section Name: WAN VLAN</div><pre class="code" id="code-wanvlan"></pre><div class="copyRow"><button class="btn" data-copy="code-wanvlan">Copy</button></div></div>
            <div id="sec-vcgvlan" style="display:none;"><div class="sectionTitle">Section Name: VCG VLAN</div><pre class="code" id="code-vcgvlan"></pre><div class="copyRow"><button class="btn" data-copy="code-vcgvlan">Copy</button></div></div>
            <div id="sec-route" style="display:none;"><div class="sectionTitle">Section Name: Route</div><pre class="code" id="code-route"></pre><div class="copyRow"><button class="btn" data-copy="code-route">Copy</button></div></div>
            <div id="sec-bgp" style="display:none;">
              <div class="sectionTitle">Section Name: BGP SVC Leaves 01–04</div>
              <pre class="code" id="code-bgp"></pre>
              <div class="copyRow"><button class="btn" data-copy="code-bgp">Copy</button></div>
              <div id="dontforget" style="display:none; margin-top:14px;">
                <div class="sectionTitle">Don't Forget!! (IAD only)</div>
                <pre class="code" id="code-bgp-vcg"></pre>
                <div class="copyRow"><button class="btn" data-copy="code-bgp-vcg">Copy</button></div>
              </div>
            </div>
            <div id="sec-all" style="display:none;"><div class="sectionTitle">All Sections</div><pre class="code" id="code-all"></pre><div class="copyRow"><button class="btn" data-copy="code-all">Copy All</button></div></div>
            <div class="test" id="testOut"></div>
          </div>
        </section>

        <section class="card">
          <h2>Static Route Helper</h2>
          <div class="content">
            <button class="btn" id="btnNeedStatic">Need a static route?</button>
            <div id="staticForm" style="display:none; margin-top:12px;">
              <div class="field"><label for="staticSubnet">Subnet to route</label><input id="staticSubnet" placeholder="192.0.2.0/24" /></div>
              <div class="field"><label>Output</label><pre class="code" id="staticOut"></pre></div>
              <div class="copyRow"><button class="btn" data-copy="staticOut">Copy Static Route</button></div>
              <div class="muted">Format: <code>ip route vrf RS-INET &lt;static&gt; &lt;FirewallIP&gt; tag 10 name &lt;Customer&gt;-addtl</code></div>
            </div>
          </div>
        </section>
      </div>
    </section>

    <section id="page-dcnm" class="page">
      <div class="card"><h2>DCNM</h2><div class="content"><p class="muted">Placeholder — add DCNM outputs here.</p></div></div>
    </section>

    <section id="page-localin" class="page">
      <div class="card"><h2>Local-In Policy Golden Config</h2><div class="content"><p class="muted">Placeholder — add Local-In policy content here.</p></div></div>
    </section>

    <section id="page-future" class="page">
      <div class="card"><h2>Future Page</h2><div class="content"><p class="muted">Reserved for future features.</p></div></div>
    </section>
  </div>

  <script>
    const $ = s => document.querySelector(s); const $$ = s => Array.from(document.querySelectorAll(s));
    function ipToInt(ip){const p=ip.split('.').map(Number);if(p.length!==4||p.some(n=>!Number.isInteger(n)||n<0||n>255))throw new Error('Bad IP');return (((p[0]*256+p[1])*256+p[2])*256+p[3])>>>0}
    function intToIp(x){x=x>>>0;return[(x>>>24)&255,(x>>>16)&255,(x>>>8)&255,x&255].join('.')}
    function prefixToMask(prefix){prefix=Number(prefix);if(!(prefix>=0&&prefix<=32))throw new Error('Bad prefix');const mask=prefix===0?0:(0xFFFFFFFF<<(32-prefix))>>>0;return{int:mask>>>0,dotted:intToIp(mask>>>0)}}
    function parseCIDR(cidr){const parts=cidr.trim().split('/');if(parts.length!==2)throw new Error('CIDR must be like 203.0.113.0/29');const [ipStr,pfxStr]=parts;const prefix=Number(pfxStr);if(!Number.isInteger(prefix)||prefix<0||prefix>32)throw new Error('Bad prefix');const ipInt=ipToInt(ipStr);const block=2**(32-prefix);const network=Math.floor(ipInt/block)*block>>>0;const broadcast=(network+block-1)>>>0;let first,last;if(prefix===32){first=network;last=network}else if(prefix===31){first=network;last=broadcast}else{first=(network+1)>>>0;last=(broadcast-1)>>>0}return{prefix,ipInt,ipStr,network,broadcast,first,last,mask:prefixToMask(prefix)}}
    function dcSecondOctet(dc){switch((dc||'').toUpperCase()){case 'IAD':return 101;case 'ORD':return 105;case 'LAX':return 107;default:return 100;}}
    function buildBGPLeaves(vlan, dc){
      const tag=(vlan&&vlan.length===3)?`40${vlan}`:(vlan?`4${vlan}`:'');
      const second=dcSecondOctet(dc);
      const leaves=[6,7,8,9];
      return leaves.map((octet,idx)=>{
        const n=String(idx+1).padStart(2,'0');
        return `Section Name: BGP SVC Leaf${n}
Vlan ${vlan}
     rd 10.${second}.220.${octet}:${tag}
     route-target both ${tag}:${tag}
     redistribute learned`;
      }).join('

');
    }
    function compute(){
      const cust=$('#custName')?.value.trim()||'';
      const sfid=$('#sfid')?.value.trim()||'';
      const dc=$('#dc')?.value.trim()||'';
      const wan=$('#wanVlan')?.value.trim()||'';
      const vcg=$('#vcgVlan')?.value.trim()||'';
      const cidr=$('#cidr')?.value.trim()||'';

      const wn=$('#wanNamePreview'); const vn=$('#vcgNamePreview');
      if(wn) wn.textContent = cust?`${cust} - WAN`:'(auto)';
      if(vn) vn.textContent = cust?`${cust} - VCG`:'(auto)';

      let gw='—', fw='—', mask='—';
      try{
        const { prefix, ipInt, first, last, mask:m } = parseCIDR(cidr);
        mask = m.dotted;
        if(prefix===32){ gw=fw='—'; }
        else if(prefix===31){ gw=intToIp(ipInt); fw=intToIp((ipInt+1)>>>0); }
        else { gw=intToIp(first); const second=Math.min(last,(first+1)>>>0); fw=intToIp(second); }
      }catch(e){}

      $('#gw')&&( $('#gw').textContent = gw );
      $('#fw')&&( $('#fw').textContent = fw );
      $('#mask')&&( $('#mask').textContent = mask );
      const desc=(dc&&cust&&sfid)?`(${dc}) - ${cust} - ${sfid}`:'—';
      $('#desc')&&( $('#desc').textContent = desc );

      const secWAN = `vlan ${wan}
      name ${cust}-${sfid}-WAN`;
      const secVCG = `vlan ${vcg}
    name ${cust}-${sfid}-VCG`;
      const secRoute = `interface Vlan${wan}
  description ${cust}-${sfid}-WAN
  vrf RS-INET
  ip address ${gw} ${mask}`;
      const secBGP = buildBGPLeaves(wan, dc);
      const secBGPVCG = (dc==='IAD' ? buildBGPLeaves(vcg, dc) : '');

      const codeWan=$('#code-wanvlan'), codeVcg=$('#code-vcgvlan'), codeRoute=$('#code-route'), codeBgp=$('#code-bgp'), codeAll=$('#code-all');
      if(codeWan) codeWan.textContent = secWAN;
      if(codeVcg) codeVcg.textContent = secVCG;
      if(codeRoute) codeRoute.textContent = secRoute;
      if(codeBgp) codeBgp.textContent = secBGP;

      const dontEl=$('#dontforget'); const codeBgpVcg=$('#code-bgp-vcg');
      if(dontEl) dontEl.style.display = (dc==='IAD' ? 'block' : 'none');
      if(codeBgpVcg) codeBgpVcg.textContent = secBGPVCG;

      if(codeAll){
        const parts=[ 'Section Name: WAN VLAN',secWAN,'','Section Name: VCG VLAN',secVCG,'','Section Name: Route',secRoute,'','Section Name: BGP SVC Leaves 01–04',secBGP ];
        if(dc==='IAD'){ parts.push('', "Don't Forget!! (IAD only)", secBGPVCG); }
        codeAll.textContent = parts.join('
');
      }

      const staticSubnet = $('#staticSubnet')?.value.trim();
      if(staticSubnet){
        const out = `ip route vrf RS-INET ${staticSubnet} ${fw} tag 10 name ${cust}-addtl`;
        const node = $('#staticOut'); if(node) node.textContent = out;
      }
    }
    function activateTab(id){
      ['wanvlan','vcgvlan','route','bgp','all'].forEach(t=>{
        const tab=document.querySelector(`.tab[data-tab="${t}"]`);
        if(tab) tab.classList.toggle('active', t===id);
        const sec=document.querySelector(`#sec-${t}`);
        if(sec) sec.style.display=(t===id?'block':'none');
      });
    }
    function setActiveNav(){$$('a[data-route]').forEach(a=>a.classList.toggle('active',a.getAttribute('href')===location.hash));}
    function showPageFromHash(){const id=(location.hash||'#home').replace('#',''); setActiveNav(); $$('.page').forEach(p=>p.classList.remove('active')); const page=$(`#page-${id}`); if(page) page.classList.add('active');}
    function safeAttach(sel,evt,fn){const n=document.querySelector(sel); if(n) n.addEventListener(evt,fn);}
    function init(){
      ['input','change'].forEach(evt=>['#custName','#sfid','#dc','#wanVlan','#vcgVlan','#cidr','#staticSubnet'].forEach(s=>safeAttach(s,evt,compute)));
      $$('.tab').forEach(t=>t.addEventListener('click',()=>activateTab(t.dataset.tab)));
      document.addEventListener('click',(e)=>{
        const btn=e.target.closest('[data-copy]'); if(!btn) return;
        const id=btn.getAttribute('data-copy'); const node=document.getElementById(id); if(!node) return;
        navigator.clipboard.writeText(node.textContent).then(()=>{btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy',1000);});
      });
      safeAttach('#btnNeedStatic','click',()=>{const f=$('#staticForm'); if(f) f.style.display = (f.style.display==='none'?'block':'none');});
      safeAttach('#btnSample','click',()=>{ $('#custName').value='NobleGrid Networks'; $('#sfid').value='0065x00000AbCdE'; $('#dc').value='IAD'; $('#wanVlan').value='210'; $('#vcgVlan').value='1210'; $('#cidr').value='100.100.100.1/31'; compute(); });
      safeAttach('#btnReset','click',()=>{ ['#custName','#sfid','#wanVlan','#vcgVlan','#cidr','#staticSubnet'].forEach(s=>{const n=$(s); if(n) n.value='';}); const dc=$('#dc'); if(dc) dc.value=''; compute(); });
      window.addEventListener('hashchange',showPageFromHash); showPageFromHash();
      compute();
      runTests();
    }
    if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);} else {init();}
    function expectEqual(name, got, expected){ const ok = (got===expected); console[ok?'log':'error'](ok?`✔ ${name}`:`✖ ${name} (got ${got}, expected ${expected})`); return ok; }
    function runTests(){
      const out = document.getElementById('testOut'); const lines = []; const line = s => lines.push(s);
      try{
        let { mask } = parseCIDR('198.51.100.32/28'); expectEqual('mask /28', mask.dotted, '255.255.255.240');
        ({ mask } = parseCIDR('203.0.113.8/31')); expectEqual('mask /31', mask.dotted, '255.255.255.254');
        ({ mask } = parseCIDR('203.0.113.9/32')); expectEqual('mask /32', mask.dotted, '255.255.255.255');
        const tag3 = (('210').length===3)?`40${'210'}`:`4${'210'}`; expectEqual('BGP tag 210', tag3, '40210');
        const tag4 = (('1210').length===4)?`4${'1210'}`:`40${'1210'}`; expectEqual('BGP tag 1210', tag4, '41210');
        expectEqual('IAD second octet', dcSecondOctet('IAD'), 101);
        expectEqual('ORD second octet', dcSecondOctet('ORD'), 105);
        expectEqual('LAX second octet', dcSecondOctet('LAX'), 107);
        expectEqual('Default second octet', dcSecondOctet('DAL'), 100);
        const parts = ['A','B','C']; const joined = parts.join('
'); expectEqual('join newline', joined, 'A
B
C');
      }catch(e){ lines.append('Test error: '+e.message); }
      if(out) out.innerHTML = lines.join('<br/>');
    }
  </script>
</body>
</html>
